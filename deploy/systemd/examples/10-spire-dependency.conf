## SPIRE Agent Dependency Drop-in
## Install this file to /etc/systemd/system/harbor-satellite.service.d/10-spire-dependency.conf
## when using SPIFFE authentication (join-token, x509pop, or sshpop methods)
##
## This creates a hard dependency on the SPIRE agent service:
## - Harbor Satellite will start only after SPIRE agent is running
## - Harbor Satellite requires SPIRE agent to be active
##
## After installing: sudo systemctl daemon-reload

[Unit]
# Start after SPIRE agent is ready
After=spire-agent.service

# Require SPIRE agent to be running
Requires=spire-agent.service

# Optional: Stop Harbor Satellite if SPIRE agent stops
# Uncomment the line below for joint lifecycle management
# BindsTo=spire-agent.service
